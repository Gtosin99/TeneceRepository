<main>
  <% if (prods.length > 0) { %>
  <div class="grid">
    <% for(let i = 0; i < prods.length; i++) { %>
    <article class="card product-item">
      <header class="card__header">
        <h1 class="product__title"><%= prods[i].title %></h1>
      </header>
      <div class="card__image">
        <img src="\<%= prods[i].imageUrl%>" alt="A book" />
      </div>
      <div class="card__content">
        <h2 class="product__price">â‚¦<%= prods[i].price %></h2>
        <p class="product__description"><%= prods[i].description %></p>
      </div>
      <% if (name ==='shop'){ %>
      <div class="private">
        <a href="/products/<%= prods[i]._id %>" class="btn">Details</a>
        <% if(isAuthenticated){ %>
        <form action="/cart" method="post">
          <input type ="hidden" name="_csrf" value="<%= csrfToken %>">
          <input type="hidden" name="productId" value="<%= prods[i]._id %>" />
          <button class="btn">Add to Cart</button>
        </form>
         <% } %>
      </div>
      <% } else {%>
      <div class="private">
        <a href="/admin/edit-product/<%= prods[i]._id %>?edit=true" class="btn">Edit</a>
        <form action="/admin/delete-product" method="post">
            <input type ="hidden" name="_csrf" value="<%= csrfToken %>">
            <input type="hidden" name="id" value="<%= prods[i]._id.toString() %>">
          <button class="btn" type="submit">Delete</button>
        </form>
      </div>
      <% } %>
    </article>
    <% } %>
  </div>
  <% if (isindex === 1 || isindex === 2) { %>
  <section class="pagination">
    <% if (currentpage != 1 && previouspage != 1) { %>  
      <a href="<%=isindex==2 ? '/products':''%>/?page=1">1</a> 
    <% } %>

    <% if (previouspage) { %>  
      <a href="<%=isindex==2 ? '/products':''%>/?page=<%= previouspage %>"><%= previouspage %></a> 
    <% } %>

    <a href="<%=isindex==2 ? '/products':''%>/?page=<%= currentpage %>" class="active"><%= currentpage %></a>

    <% if (hasnextpage) { %>  
      <a href="<%=isindex==2 ? '/products':''%>/?page=<%= nextpage %>"><%= nextpage %></a> 
    <% } %>

    <% if (lastpage !== currentpage && nextpage !== lastpage) { %> 
      <a href="<%=isindex==2 ? '/products':''%>/?page=<%= lastpage %>"><%= lastpage %></a> 
    <% } %>
  </section>
<% } %>


  <% } else { %>
  <h1>No products found.</h1>
  <% } %>
</main>
